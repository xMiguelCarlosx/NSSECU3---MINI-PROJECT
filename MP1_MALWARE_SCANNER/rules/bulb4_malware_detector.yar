/*
 * YARA Rule for bulb4-ch4n Malware Detection
 * Author: [Your Name]
 * Date: 2026-02-19
 * Description: Detects bulb4-ch4n malware components
 */

rule MALWARE_bulb4_ch4n_python_dll {
    meta:
        author = "[Your Name]"
        description = "Detects Python DLL used by bulb4-ch4n malware"
        date = "2026-02-19"
        hash_md5 = "3c388ce47c0d9117d2a50b3fa5ac981d"
    
    strings:
        $python_id = "Python" ascii
        $dll_version = "3.12" ascii
        $mz = { 4d 5a }
        
    condition:
        $mz at 0 and $python_id and $dll_version
}

rule MALWARE_bulb4_ch4n_pyinstaller {
    meta:
        author = "[Your Name]"
        description = "Detects PyInstaller extraction artifacts"
        date = "2026-02-19"
    
    strings:
        $mei = "_MEI" ascii
        $python_dll = "python312.dll" ascii
        $base_zip = "base_library.zip" ascii
        
    condition:
        any of ($mei, $python_dll, $base_zip)
}

rule MALWARE_bulb4_ch4n_memory {
    meta:
        author = "[Your Name]"
        description = "Detects bulb4-ch4n in memory"
        date = "2026-02-19"
    
    strings:
        $name = "bulb4-ch4n.exe" ascii
        $parent = "spoolsv.exe" ascii
        
    condition:
        any of them
}