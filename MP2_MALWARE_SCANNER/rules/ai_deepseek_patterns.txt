PATTERN NAME: PE_MZ_HEADER
DESCRIPTION: Detects Windows PE executables by their MZ header at file beginning
OFFSET: 0
HEX PATTERN: 4D 5A
STRING PATTERN: 
FILE TYPES: PE

PATTERN NAME: PE_DOS_MESSAGE
DESCRIPTION: Detects the standard DOS stub message in PE files
OFFSET: anywhere
HEX PATTERN: 54 68 69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F 74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20 6D 6F 64 65
STRING PATTERN: This program cannot be run in DOS mode
FILE TYPES: PE

PATTERN NAME: PE_API_VIRTUALALLOC
DESCRIPTION: Detects VirtualAlloc API import often used for memory allocation in malware
OFFSET: anywhere
HEX PATTERN: 56 69 72 74 75 61 6C 41 6C 6C 6F 63
STRING PATTERN: VirtualAlloc
FILE TYPES: PE

PATTERN NAME: PE_API_CREATEREMOTETHREAD
DESCRIPTION: Detects CreateRemoteThread API used for process injection
OFFSET: anywhere
HEX PATTERN: 43 72 65 61 74 65 52 65 6D 6F 74 65 54 68 72 65 61 64
STRING PATTERN: CreateRemoteThread
FILE TYPES: PE

PATTERN NAME: PE_API_WRITEPROCESSMEMORY
DESCRIPTION: Detects WriteProcessMemory API used for process injection
OFFSET: anywhere
HEX PATTERN: 57 72 69 74 65 50 72 6F 63 65 73 73 4D 65 6D 6F 72 79
STRING PATTERN: WriteProcessMemory
FILE TYPES: PE

PATTERN NAME: PE_UPX0_SECTION
DESCRIPTION: Detects UPX packed executables by section name UPX0
OFFSET: anywhere
HEX PATTERN: 55 50 58 30
STRING PATTERN: UPX0
FILE TYPES: PE

PATTERN NAME: PE_UPX1_SECTION
DESCRIPTION: Detects UPX packed executables by section name UPX1
OFFSET: anywhere
HEX PATTERN: 55 50 58 31
STRING PATTERN: UPX1
FILE TYPES: PE

PATTERN NAME: PE_ASPACK_SECTION
DESCRIPTION: Detects ASPack packed executables by section name .aspack
OFFSET: anywhere
HEX PATTERN: 2E 61 73 70 61 63 6B
STRING PATTERN: .aspack
FILE TYPES: PE

PATTERN NAME: PE_ADATA_SECTION
DESCRIPTION: Detects ASPack packed executables by section name .adata
OFFSET: anywhere
HEX PATTERN: 2E 61 64 61 74 61
STRING PATTERN: .adata
FILE TYPES: PE

PATTERN NAME: PE_VMP0_SECTION
DESCRIPTION: Detects VMProtect packed executables by section name .vmp0
OFFSET: anywhere
HEX PATTERN: 2E 76 6D 70 30
STRING PATTERN: .vmp0
FILE TYPES: PE

PATTERN NAME: PDF_HEADER
DESCRIPTION: Detects PDF files by their header
OFFSET: 0
HEX PATTERN: 25 50 44 46
STRING PATTERN: %PDF
FILE TYPES: PDF

PATTERN NAME: PDF_JAVASCRIPT_TAG
DESCRIPTION: Detects JavaScript in PDF documents
OFFSET: anywhere
HEX PATTERN: 2F 4A 61 76 61 53 63 72 69 70 74
STRING PATTERN: /JavaScript
FILE TYPES: PDF

PATTERN NAME: PDF_JS_TAG
DESCRIPTION: Detects JavaScript in PDF documents (short form)
OFFSET: anywhere
HEX PATTERN: 2F 4A 53
STRING PATTERN: /JS
FILE TYPES: PDF

PATTERN NAME: PDF_OPENACTION_TAG
DESCRIPTION: Detects auto-execute actions in PDF
OFFSET: anywhere
HEX PATTERN: 2F 4F 70 65 6E 41 63 74 69 6F 6E
STRING PATTERN: /OpenAction
FILE TYPES: PDF

PATTERN NAME: PDF_LAUNCH_TAG
DESCRIPTION: Detects launch actions in PDF
OFFSET: anywhere
HEX PATTERN: 2F 4C 61 75 6E 63 68
STRING PATTERN: /Launch
FILE TYPES: PDF

PATTERN NAME: PDF_EMBEDDEDFILE_TAG
DESCRIPTION: Detects embedded files in PDF
OFFSET: anywhere
HEX PATTERN: 2F 45 6D 62 65 64 64 65 64 46 69 6C 65
STRING PATTERN: /EmbeddedFile
FILE TYPES: PDF

PATTERN NAME: PDF_EVAL_STRING
DESCRIPTION: Detects eval() in PDF JavaScript
OFFSET: anywhere
HEX PATTERN: 65 76 61 6C 28
STRING PATTERN: eval(
FILE TYPES: PDF

PATTERN NAME: OFFICE_OLE_HEADER
DESCRIPTION: Detects legacy Office documents (OLE2 format)
OFFSET: 0
HEX PATTERN: D0 CF 11 E0 A1 B1 1A E1
STRING PATTERN: 
FILE TYPES: Office

PATTERN NAME: OFFICE_PK_HEADER
DESCRIPTION: Detects modern Office documents (Open XML format)
OFFSET: 0
HEX PATTERN: 50 4B 03 04
STRING PATTERN: PK
FILE TYPES: Office

PATTERN NAME: OFFICE_AUTO_OPEN
DESCRIPTION: Detects Auto_Open macro in Office documents
OFFSET: anywhere
HEX PATTERN: 41 75 74 6F 5F 4F 70 65 6E
STRING PATTERN: Auto_Open
FILE TYPES: Office

PATTERN NAME: OFFICE_DOCUMENT_OPEN
DESCRIPTION: Detects Document_Open macro in Office documents
OFFSET: anywhere
HEX PATTERN: 44 6F 63 75 6D 65 6E 74 5F 4F 70 65 6E
STRING PATTERN: Document_Open
FILE TYPES: Office

PATTERN NAME: OFFICE_WSCRIPT_SHELL
DESCRIPTION: Detects WScript.Shell object creation in Office macros
OFFSET: anywhere
HEX PATTERN: 57 53 63 72 69 70 74 2E 53 68 65 6C 6C
STRING PATTERN: WScript.Shell
FILE TYPES: Office

PATTERN NAME: OFFICE_CREATEOBJECT
DESCRIPTION: Detects CreateObject function in Office macros
OFFSET: anywhere
HEX PATTERN: 43 72 65 61 74 65 4F 62 6A 65 63 74
STRING PATTERN: CreateObject
FILE TYPES: Office

PATTERN NAME: OFFICE_SHELL_APPLICATION
DESCRIPTION: Detects Shell.Application object in Office macros
OFFSET: anywhere
HEX PATTERN: 53 68 65 6C 6C 2E 41 70 70 6C 69 63 61 74 69 6F 6E
STRING PATTERN: Shell.Application
FILE TYPES: Office

PATTERN NAME: OFFICE_POWERSHELL_EXE
DESCRIPTION: Detects PowerShell execution from Office macros
OFFSET: anywhere
HEX PATTERN: 70 6F 77 65 72 73 68 65 6C 6C 2E 65 78 65
STRING PATTERN: powershell.exe
FILE TYPES: Office

PATTERN NAME: OFFICE_CMD_EXE
DESCRIPTION: Detects cmd.exe execution from Office macros
OFFSET: anywhere
HEX PATTERN: 63 6D 64 2E 65 78 65 20 2F 63
STRING PATTERN: cmd.exe /c
FILE TYPES: Office

PATTERN NAME: JS_EVAL
DESCRIPTION: Detects eval() function in JavaScript (obfuscation)
OFFSET: anywhere
HEX PATTERN: 65 76 61 6C 28
STRING PATTERN: eval(
FILE TYPES: JS

PATTERN NAME: JS_UNESCAPE
DESCRIPTION: Detects unescape() function in JavaScript (obfuscation)
OFFSET: anywhere
HEX PATTERN: 75 6E 65 73 63 61 70 65 28
STRING PATTERN: unescape(
FILE TYPES: JS

PATTERN NAME: JS_DECODEURICOMPONENT
DESCRIPTION: Detects decodeURIComponent() function in JavaScript (obfuscation)
OFFSET: anywhere
HEX PATTERN: 64 65 63 6F 64 65 55 52 49 43 6F 6D 70 6F 6E 65 6E 74 28
STRING PATTERN: decodeURIComponent(
FILE TYPES: JS

PATTERN NAME: JS_ACTIVEXOBJECT
DESCRIPTION: Detects ActiveXObject creation in JavaScript
OFFSET: anywhere
HEX PATTERN: 41 63 74 69 76 65 58 4F 62 6A 65 63 74
STRING PATTERN: ActiveXObject
FILE TYPES: JS

PATTERN NAME: JS_WSCRIPT_SHELL
DESCRIPTION: Detects WScript.Shell in JavaScript
OFFSET: anywhere
HEX PATTERN: 57 53 63 72 69 70 74 2E 53 68 65 6C 6C
STRING PATTERN: WScript.Shell
FILE TYPES: JS

PATTERN NAME: JS_XMLHTTPREQUEST
DESCRIPTION: Detects XMLHttpRequest for network requests
OFFSET: anywhere
HEX PATTERN: 58 4D 4C 48 74 74 70 52 65 71 75 65 73 74
STRING PATTERN: XMLHttpRequest
FILE TYPES: JS

PATTERN NAME: JS_ADODB_STREAM
DESCRIPTION: Detects ADODB.Stream for file operations
OFFSET: anywhere
HEX PATTERN: 41 44 4F 44 42 2E 53 74 72 65 61 6D
STRING PATTERN: ADODB.Stream
FILE TYPES: JS

PATTERN NAME: PS_EXECUTIONPOLICY_BYPASS
DESCRIPTION: Detects PowerShell execution policy bypass
OFFSET: anywhere
HEX PATTERN: 2D 45 78 65 63 75 74 69 6F 6E 50 6F 6C 69 63 79 20 42 79 70 61 73 73
STRING PATTERN: -ExecutionPolicy Bypass
FILE TYPES: PS

PATTERN NAME: PS_WINDOWSTYLE_HIDDEN
DESCRIPTION: Detects hidden PowerShell window execution
OFFSET: anywhere
HEX PATTERN: 2D 57 69 6E 64 6F 77 53 74 79 6C 65 20 48 69 64 64 65 6E
STRING PATTERN: -WindowStyle Hidden
FILE TYPES: PS

PATTERN NAME: PS_DOWNLOADSTRING
DESCRIPTION: Detects DownloadString method for payload retrieval
OFFSET: anywhere
HEX PATTERN: 44 6F 77 6E 6C 6F 61 64 53 74 72 69 6E 67
STRING PATTERN: DownloadString
FILE TYPES: PS

PATTERN NAME: PS_INVOKE_WEBREQUEST
DESCRIPTION: Detects Invoke-WebRequest cmdlet for downloading
OFFSET: anywhere
HEX PATTERN: 49 6E 76 6F 6B 65 2D 57 65 62 52 65 71 75 65 73 74
STRING PATTERN: Invoke-WebRequest
FILE TYPES: PS

PATTERN NAME: PS_ENCODEDCOMMAND
DESCRIPTION: Detects encoded PowerShell commands
OFFSET: anywhere
HEX PATTERN: 2D 45 6E 63 6F 64 65 64 43 6F 6D 6D 61 6E 64
STRING PATTERN: -EncodedCommand
FILE TYPES: PS

PATTERN NAME: PS_ENC_SHORT
DESCRIPTION: Detects short form of encoded command
OFFSET: anywhere
HEX PATTERN: 2D 65 6E 63
STRING PATTERN: -enc
FILE TYPES: PS

PATTERN NAME: PS_NET_WEBCLIENT
DESCRIPTION: Detects System.Net.WebClient for downloading
OFFSET: anywhere
HEX PATTERN: 53 79 73 74 65 6D 2E 4E 65 74 2E 57 65 62 43 6C 69 65 6E 74
STRING PATTERN: System.Net.WebClient
FILE TYPES: PS

PATTERN NAME: BACKDOOR_REGISTRY_RUN
DESCRIPTION: Detects registry run key persistence
OFFSET: anywhere
HEX PATTERN: 43 75 72 72 65 6E 74 56 65 72 73 69 6F 6E 5C 5C 52 75 6E
STRING PATTERN: CurrentVersion\\Run
FILE TYPES: Any

PATTERN NAME: BACKDOOR_SCHTASKS_CREATE
DESCRIPTION: Detects scheduled task creation for persistence
OFFSET: anywhere
HEX PATTERN: 73 63 68 74 61 73 6B 73 20 2F 63 72 65 61 74 65
STRING PATTERN: schtasks /create
FILE TYPES: Any

PATTERN NAME: BACKDOOR_STARTUP_FOLDER
DESCRIPTION: Detects startup folder persistence
OFFSET: anywhere
HEX PATTERN: 53 74 61 72 74 75 70 5C 5C 50 72 6F 67 72 61 6D 73
STRING PATTERN: Startup\\Programs
FILE TYPES: Any

PATTERN NAME: BACKDOOR_HTTP_URL
DESCRIPTION: Detects HTTP URLs for C2 communication
OFFSET: anywhere
HEX PATTERN: 68 74 74 70 3A 2F 2F
STRING PATTERN: http://
FILE TYPES: Any

PATTERN NAME: BACKDOOR_HTTPS_URL
DESCRIPTION: Detects HTTPS URLs for C2 communication
OFFSET: anywhere
HEX PATTERN: 68 74 74 70 73 3A 2F 2F
STRING PATTERN: https://
FILE TYPES: Any

PATTERN NAME: BACKDOOR_CMD_SHELL
DESCRIPTION: Detects cmd.exe execution for backdoor commands
OFFSET: anywhere
HEX PATTERN: 63 6D 64 2E 65 78 65
STRING PATTERN: cmd.exe
FILE TYPES: Any

PATTERN NAME: BACKDOOR_POWERSHELL
DESCRIPTION: Detects PowerShell execution for backdoor commands
OFFSET: anywhere
HEX PATTERN: 70 6F 77 65 72 73 68 65 6C 6C 2E 65 78 65
STRING PATTERN: powershell.exe
FILE TYPES: Any

PATTERN NAME: BACKDOOR_REVERSE_SHELL
DESCRIPTION: Detects reverse shell command patterns
OFFSET: anywhere
HEX PATTERN: 72 65 76 65 72 73 65 20 73 68 65 6C 6C
STRING PATTERN: reverse shell
FILE TYPES: Any

PATTERN NAME: COMBINED_BACKDOOR_PERSISTENCE
DESCRIPTION: Detects multiple backdoor persistence mechanisms
OFFSET: anywhere
HEX PATTERN: 
STRING PATTERN: 
FILE TYPES: Any
NOTE: This is a meta-pattern - the scanner should check for any of the backdoor patterns above