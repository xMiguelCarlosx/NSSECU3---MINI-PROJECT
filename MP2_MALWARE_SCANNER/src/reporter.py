"""
Reporter module for JSON and CSV export.
"""
import json
import csv
from pathlib import Path
from typing import List, Dict  # ‚Üê ADD THIS IMPORT

class ScanReporter:
    """Handle report generation."""
    
    @staticmethod
    def save_json(results: Dict, filepath: Path):
        """Save results as JSON."""
        with open(filepath, 'w') as f:
            json.dump(results, f, indent=2)
    
    @staticmethod
    def save_csv(results: Dict, filepath: Path):
        """Save results as CSV."""
        with open(filepath, 'w', newline='') as f:
            writer = csv.writer(f)
            # Write header
            writer.writerow([
                'Filename', 'File Type', 'MD5', 'SHA1', 'SHA256', 
                'Malicious', 'Patterns Matched'
            ])
            # Write rows
            for r in results.get('results', []):
                pattern_names = []
                if r.get('pattern_matches', {}).get('matched'):
                    pattern_names = [p['pattern_name'] for p in r['pattern_matches'].get('patterns', [])]
                
                writer.writerow([
                    r.get('filename', ''),
                    r.get('file_type', {}).get('description', ''),
                    r.get('hashes', {}).get('md5', ''),
                    r.get('hashes', {}).get('sha1', ''),
                    r.get('hashes', {}).get('sha256', ''),
                    r.get('is_malicious', False),
                    ', '.join(pattern_names)
                ])